"use strict";
var vg_scrub_bar_cue_points_1 = require("./vg-scrub-bar-cue-points");
var vg_api_1 = require("../../../services/vg-api");
describe('Scrub bar current time', function () {
    var scrubBarCuePoints;
    var ref;
    var api;
    beforeEach(function () {
        ref = {
            nativeElement: {
                getAttribute: function (name) {
                    return name;
                },
                subscriptions: {
                    loadedMetadata: {
                        subscribe: function () { }
                    }
                }
            }
        };
        api = new vg_api_1.VgAPI();
        scrubBarCuePoints = new vg_scrub_bar_cue_points_1.VgScrubBarCuePoints(ref, api);
    });
    it('Should create cue points when metadata is loaded', function () {
        var cps = {
            length: 3
        };
        var cp1 = { startTime: 1 };
        var cp2 = { startTime: 5, endTime: 10 };
        var cp3 = { startTime: 15, endTime: 20, text: "{value: 'custom params'}" };
        cps[0] = cp1;
        cps[1] = cp2;
        cps[2] = cp3;
        scrubBarCuePoints.cuePoints = cps;
        scrubBarCuePoints.target = {
            time: {
                total: 100000
            }
        };
        scrubBarCuePoints.ngOnChanges({ 'cuePoints': { currentValue: cps } });
        expect(scrubBarCuePoints.cuePoints[0].$$style).toEqual({ width: '1%', left: '1%' });
        expect(scrubBarCuePoints.cuePoints[1].$$style).toEqual({ width: '5%', left: '5%' });
        expect(scrubBarCuePoints.cuePoints[2].$$style).toEqual({ width: '5%', left: '15%' });
    });
    it('Should not calculate style position if there is not duration on media', function () {
        var cps = {
            length: 3
        };
        var cp1 = { startTime: 1 };
        var cp2 = { startTime: 5, endTime: 10 };
        var cp3 = { startTime: 15, endTime: 20, text: "{value: 'custom params'}" };
        cps[0] = cp1;
        cps[1] = cp2;
        cps[2] = cp3;
        scrubBarCuePoints.cuePoints = cps;
        scrubBarCuePoints.target = {
            time: {
                total: 0
            }
        };
        scrubBarCuePoints.ngOnChanges({ 'cuePoints': { currentValue: cps } });
        expect(scrubBarCuePoints.cuePoints[0].$$style).toEqual({ width: '0', left: '0' });
        expect(scrubBarCuePoints.cuePoints[1].$$style).toEqual({ width: '0', left: '0' });
        expect(scrubBarCuePoints.cuePoints[2].$$style).toEqual({ width: '0', left: '0' });
    });
    it('Should do nothing if there are no cue points', function () {
        scrubBarCuePoints.cuePoints = null;
        scrubBarCuePoints.onLoadedMetadata();
        scrubBarCuePoints.ngOnChanges({ 'cuePoints': { currentValue: null } });
    });
    it('Should handle after view init event', function () {
        spyOn(scrubBarCuePoints.API, 'getMediaById').and.callFake(function () {
            return ref.nativeElement;
        });
        spyOn(ref.nativeElement.subscriptions.loadedMetadata, 'subscribe').and.callThrough();
        scrubBarCuePoints.onPlayerReady();
        expect(ref.nativeElement.subscriptions.loadedMetadata.subscribe).toHaveBeenCalled();
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmctc2NydWItYmFyLWN1ZS1wb2ludHMuc3BlYy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInZnLXNjcnViLWJhci1jdWUtcG9pbnRzLnNwZWMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLHdDQUFrQywyQkFBMkIsQ0FBQyxDQUFBO0FBQzlELHVCQUFvQiwwQkFBMEIsQ0FBQyxDQUFBO0FBRy9DLFFBQVEsQ0FBQyx3QkFBd0IsRUFBRTtJQUMvQixJQUFJLGlCQUFzQyxDQUFDO0lBQzNDLElBQUksR0FBYyxDQUFDO0lBQ25CLElBQUksR0FBUyxDQUFDO0lBRWQsVUFBVSxDQUFDO1FBQ1AsR0FBRyxHQUFHO1lBQ0YsYUFBYSxFQUFFO2dCQUNYLFlBQVksRUFBRSxVQUFDLElBQUk7b0JBQ2YsTUFBTSxDQUFDLElBQUksQ0FBQztnQkFDaEIsQ0FBQztnQkFDRCxhQUFhLEVBQUU7b0JBQ1gsY0FBYyxFQUFFO3dCQUNaLFNBQVMsRUFBRSxjQUFPLENBQUM7cUJBQ3RCO2lCQUNKO2FBQ0o7U0FDSixDQUFDO1FBRUYsR0FBRyxHQUFHLElBQUksY0FBSyxFQUFFLENBQUM7UUFFbEIsaUJBQWlCLEdBQUcsSUFBSSw2Q0FBbUIsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUM7SUFDMUQsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMsa0RBQWtELEVBQUU7UUFDbkQsSUFBSSxHQUFHLEdBQVU7WUFDYixNQUFNLEVBQUUsQ0FBQztTQUNaLENBQUM7UUFDRixJQUFJLEdBQUcsR0FBK0IsRUFBQyxTQUFTLEVBQUUsQ0FBQyxFQUFFLENBQUM7UUFDdEQsSUFBSSxHQUFHLEdBQStCLEVBQUMsU0FBUyxFQUFFLENBQUMsRUFBRSxPQUFPLEVBQUUsRUFBRSxFQUFFLENBQUM7UUFDbkUsSUFBSSxHQUFHLEdBQStCLEVBQUMsU0FBUyxFQUFFLEVBQUUsRUFBRSxPQUFPLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBRSwwQkFBMEIsRUFBRSxDQUFDO1FBRXRHLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUM7UUFDYixHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDO1FBQ2IsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQztRQUViLGlCQUFpQixDQUFDLFNBQVMsR0FBc0IsR0FBSSxDQUFDO1FBRXRELGlCQUFpQixDQUFDLE1BQU0sR0FBRztZQUN2QixJQUFJLEVBQUU7Z0JBQ0YsS0FBSyxFQUFFLE1BQU07YUFDaEI7U0FDSixDQUFDO1FBRUYsaUJBQWlCLENBQUMsV0FBVyxDQUFDLEVBQUMsV0FBVyxFQUFpQixFQUFDLFlBQVksRUFBRSxHQUFHLEVBQUUsRUFBQyxDQUFDLENBQUM7UUFFbEYsTUFBTSxDQUFPLGlCQUFpQixDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBQyxLQUFLLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUMsQ0FBQyxDQUFDO1FBQ3pGLE1BQU0sQ0FBTyxpQkFBaUIsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFFLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUMsS0FBSyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFDLENBQUMsQ0FBQztRQUN6RixNQUFNLENBQU8saUJBQWlCLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBRSxDQUFDLE9BQU8sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxFQUFDLEtBQUssRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBQyxDQUFDLENBQUM7SUFDOUYsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMsdUVBQXVFLEVBQUU7UUFDeEUsSUFBSSxHQUFHLEdBQVU7WUFDYixNQUFNLEVBQUUsQ0FBQztTQUNaLENBQUM7UUFDRixJQUFJLEdBQUcsR0FBK0IsRUFBQyxTQUFTLEVBQUUsQ0FBQyxFQUFFLENBQUM7UUFDdEQsSUFBSSxHQUFHLEdBQStCLEVBQUMsU0FBUyxFQUFFLENBQUMsRUFBRSxPQUFPLEVBQUUsRUFBRSxFQUFFLENBQUM7UUFDbkUsSUFBSSxHQUFHLEdBQStCLEVBQUMsU0FBUyxFQUFFLEVBQUUsRUFBRSxPQUFPLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBRSwwQkFBMEIsRUFBRSxDQUFDO1FBRXRHLEdBQUcsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUM7UUFDYixHQUFHLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDO1FBQ2IsR0FBRyxDQUFDLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQztRQUViLGlCQUFpQixDQUFDLFNBQVMsR0FBc0IsR0FBSSxDQUFDO1FBRXRELGlCQUFpQixDQUFDLE1BQU0sR0FBRztZQUN2QixJQUFJLEVBQUU7Z0JBQ0YsS0FBSyxFQUFFLENBQUM7YUFDWDtTQUNKLENBQUM7UUFFRixpQkFBaUIsQ0FBQyxXQUFXLENBQUMsRUFBQyxXQUFXLEVBQWlCLEVBQUMsWUFBWSxFQUFFLEdBQUcsRUFBRSxFQUFDLENBQUMsQ0FBQztRQUVsRixNQUFNLENBQU8saUJBQWlCLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBRSxDQUFDLE9BQU8sQ0FBQyxDQUFDLE9BQU8sQ0FBQyxFQUFDLEtBQUssRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFFLEdBQUcsRUFBQyxDQUFDLENBQUM7UUFDdkYsTUFBTSxDQUFPLGlCQUFpQixDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBQyxLQUFLLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxHQUFHLEVBQUMsQ0FBQyxDQUFDO1FBQ3ZGLE1BQU0sQ0FBTyxpQkFBaUIsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFFLENBQUMsT0FBTyxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUMsS0FBSyxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFDLENBQUMsQ0FBQztJQUMzRixDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyw4Q0FBOEMsRUFBRTtRQUMvQyxpQkFBaUIsQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDO1FBQ25DLGlCQUFpQixDQUFDLGdCQUFnQixFQUFFLENBQUM7UUFDckMsaUJBQWlCLENBQUMsV0FBVyxDQUFDLEVBQUMsV0FBVyxFQUFpQixFQUFDLFlBQVksRUFBRSxJQUFJLEVBQUUsRUFBQyxDQUFDLENBQUM7SUFDdkYsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMscUNBQXFDLEVBQUU7UUFDdEMsS0FBSyxDQUFDLGlCQUFpQixDQUFDLEdBQUcsRUFBRSxjQUFjLENBQUMsQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUNyRDtZQUNJLE1BQU0sQ0FBQyxHQUFHLENBQUMsYUFBYSxDQUFDO1FBQzdCLENBQUMsQ0FDSixDQUFDO1FBRUYsS0FBSyxDQUFDLEdBQUcsQ0FBQyxhQUFhLENBQUMsYUFBYSxDQUFDLGNBQWMsRUFBRSxXQUFXLENBQUMsQ0FBQyxHQUFHLENBQUMsV0FBVyxFQUFFLENBQUM7UUFFckYsaUJBQWlCLENBQUMsYUFBYSxFQUFFLENBQUM7UUFFbEMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxhQUFhLENBQUMsYUFBYSxDQUFDLGNBQWMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO0lBQ3hGLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1ZnU2NydWJCYXJDdWVQb2ludHN9IGZyb20gXCIuL3ZnLXNjcnViLWJhci1jdWUtcG9pbnRzXCI7XG5pbXBvcnQge1ZnQVBJfSBmcm9tIFwiLi4vLi4vLi4vc2VydmljZXMvdmctYXBpXCI7XG5pbXBvcnQge0VsZW1lbnRSZWYsIFNpbXBsZUNoYW5nZX0gZnJvbSBcIkBhbmd1bGFyL2NvcmVcIjtcblxuZGVzY3JpYmUoJ1NjcnViIGJhciBjdXJyZW50IHRpbWUnLCAoKSA9PiB7XG4gICAgbGV0IHNjcnViQmFyQ3VlUG9pbnRzOiBWZ1NjcnViQmFyQ3VlUG9pbnRzO1xuICAgIGxldCByZWY6RWxlbWVudFJlZjtcbiAgICBsZXQgYXBpOlZnQVBJO1xuXG4gICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICAgIHJlZiA9IHtcbiAgICAgICAgICAgIG5hdGl2ZUVsZW1lbnQ6IHtcbiAgICAgICAgICAgICAgICBnZXRBdHRyaWJ1dGU6IChuYW1lKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBuYW1lO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgc3Vic2NyaXB0aW9uczoge1xuICAgICAgICAgICAgICAgICAgICBsb2FkZWRNZXRhZGF0YToge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3Vic2NyaWJlOiAoKSA9PiB7fVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGFwaSA9IG5ldyBWZ0FQSSgpO1xuXG4gICAgICAgIHNjcnViQmFyQ3VlUG9pbnRzID0gbmV3IFZnU2NydWJCYXJDdWVQb2ludHMocmVmLCBhcGkpO1xuICAgIH0pO1xuXG4gICAgaXQoJ1Nob3VsZCBjcmVhdGUgY3VlIHBvaW50cyB3aGVuIG1ldGFkYXRhIGlzIGxvYWRlZCcsICgpID0+IHtcbiAgICAgICAgdmFyIGNwczpPYmplY3QgPSB7XG4gICAgICAgICAgICBsZW5ndGg6IDNcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGNwMTpUZXh0VHJhY2tDdWUgPSAoPFRleHRUcmFja0N1ZT57c3RhcnRUaW1lOiAxfSk7XG4gICAgICAgIHZhciBjcDI6VGV4dFRyYWNrQ3VlID0gKDxUZXh0VHJhY2tDdWU+e3N0YXJ0VGltZTogNSwgZW5kVGltZTogMTB9KTtcbiAgICAgICAgdmFyIGNwMzpUZXh0VHJhY2tDdWUgPSAoPFRleHRUcmFja0N1ZT57c3RhcnRUaW1lOiAxNSwgZW5kVGltZTogMjAsIHRleHQ6IFwie3ZhbHVlOiAnY3VzdG9tIHBhcmFtcyd9XCJ9KTtcblxuICAgICAgICBjcHNbMF0gPSBjcDE7XG4gICAgICAgIGNwc1sxXSA9IGNwMjtcbiAgICAgICAgY3BzWzJdID0gY3AzO1xuXG4gICAgICAgIHNjcnViQmFyQ3VlUG9pbnRzLmN1ZVBvaW50cyA9ICg8VGV4dFRyYWNrQ3VlTGlzdD5jcHMpO1xuXG4gICAgICAgIHNjcnViQmFyQ3VlUG9pbnRzLnRhcmdldCA9IHtcbiAgICAgICAgICAgIHRpbWU6IHtcbiAgICAgICAgICAgICAgICB0b3RhbDogMTAwMDAwXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgc2NydWJCYXJDdWVQb2ludHMubmdPbkNoYW5nZXMoeydjdWVQb2ludHMnOiAoPFNpbXBsZUNoYW5nZT57Y3VycmVudFZhbHVlOiBjcHN9KX0pO1xuXG4gICAgICAgIGV4cGVjdCgoPGFueT5zY3J1YkJhckN1ZVBvaW50cy5jdWVQb2ludHNbMF0pLiQkc3R5bGUpLnRvRXF1YWwoe3dpZHRoOiAnMSUnLCBsZWZ0OiAnMSUnfSk7XG4gICAgICAgIGV4cGVjdCgoPGFueT5zY3J1YkJhckN1ZVBvaW50cy5jdWVQb2ludHNbMV0pLiQkc3R5bGUpLnRvRXF1YWwoe3dpZHRoOiAnNSUnLCBsZWZ0OiAnNSUnfSk7XG4gICAgICAgIGV4cGVjdCgoPGFueT5zY3J1YkJhckN1ZVBvaW50cy5jdWVQb2ludHNbMl0pLiQkc3R5bGUpLnRvRXF1YWwoe3dpZHRoOiAnNSUnLCBsZWZ0OiAnMTUlJ30pO1xuICAgIH0pO1xuXG4gICAgaXQoJ1Nob3VsZCBub3QgY2FsY3VsYXRlIHN0eWxlIHBvc2l0aW9uIGlmIHRoZXJlIGlzIG5vdCBkdXJhdGlvbiBvbiBtZWRpYScsICgpID0+IHtcbiAgICAgICAgdmFyIGNwczpPYmplY3QgPSB7XG4gICAgICAgICAgICBsZW5ndGg6IDNcbiAgICAgICAgfTtcbiAgICAgICAgdmFyIGNwMTpUZXh0VHJhY2tDdWUgPSAoPFRleHRUcmFja0N1ZT57c3RhcnRUaW1lOiAxfSk7XG4gICAgICAgIHZhciBjcDI6VGV4dFRyYWNrQ3VlID0gKDxUZXh0VHJhY2tDdWU+e3N0YXJ0VGltZTogNSwgZW5kVGltZTogMTB9KTtcbiAgICAgICAgdmFyIGNwMzpUZXh0VHJhY2tDdWUgPSAoPFRleHRUcmFja0N1ZT57c3RhcnRUaW1lOiAxNSwgZW5kVGltZTogMjAsIHRleHQ6IFwie3ZhbHVlOiAnY3VzdG9tIHBhcmFtcyd9XCJ9KTtcblxuICAgICAgICBjcHNbMF0gPSBjcDE7XG4gICAgICAgIGNwc1sxXSA9IGNwMjtcbiAgICAgICAgY3BzWzJdID0gY3AzO1xuXG4gICAgICAgIHNjcnViQmFyQ3VlUG9pbnRzLmN1ZVBvaW50cyA9ICg8VGV4dFRyYWNrQ3VlTGlzdD5jcHMpO1xuXG4gICAgICAgIHNjcnViQmFyQ3VlUG9pbnRzLnRhcmdldCA9IHtcbiAgICAgICAgICAgIHRpbWU6IHtcbiAgICAgICAgICAgICAgICB0b3RhbDogMFxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHNjcnViQmFyQ3VlUG9pbnRzLm5nT25DaGFuZ2VzKHsnY3VlUG9pbnRzJzogKDxTaW1wbGVDaGFuZ2U+e2N1cnJlbnRWYWx1ZTogY3BzfSl9KTtcblxuICAgICAgICBleHBlY3QoKDxhbnk+c2NydWJCYXJDdWVQb2ludHMuY3VlUG9pbnRzWzBdKS4kJHN0eWxlKS50b0VxdWFsKHt3aWR0aDogJzAnLCBsZWZ0OiAnMCd9KTtcbiAgICAgICAgZXhwZWN0KCg8YW55PnNjcnViQmFyQ3VlUG9pbnRzLmN1ZVBvaW50c1sxXSkuJCRzdHlsZSkudG9FcXVhbCh7d2lkdGg6ICcwJywgbGVmdDogJzAnfSk7XG4gICAgICAgIGV4cGVjdCgoPGFueT5zY3J1YkJhckN1ZVBvaW50cy5jdWVQb2ludHNbMl0pLiQkc3R5bGUpLnRvRXF1YWwoe3dpZHRoOiAnMCcsIGxlZnQ6ICcwJ30pO1xuICAgIH0pO1xuXG4gICAgaXQoJ1Nob3VsZCBkbyBub3RoaW5nIGlmIHRoZXJlIGFyZSBubyBjdWUgcG9pbnRzJywgKCkgPT4ge1xuICAgICAgICBzY3J1YkJhckN1ZVBvaW50cy5jdWVQb2ludHMgPSBudWxsO1xuICAgICAgICBzY3J1YkJhckN1ZVBvaW50cy5vbkxvYWRlZE1ldGFkYXRhKCk7XG4gICAgICAgIHNjcnViQmFyQ3VlUG9pbnRzLm5nT25DaGFuZ2VzKHsnY3VlUG9pbnRzJzogKDxTaW1wbGVDaGFuZ2U+e2N1cnJlbnRWYWx1ZTogbnVsbH0pfSk7XG4gICAgfSk7XG5cbiAgICBpdCgnU2hvdWxkIGhhbmRsZSBhZnRlciB2aWV3IGluaXQgZXZlbnQnLCAoKSA9PiB7XG4gICAgICAgIHNweU9uKHNjcnViQmFyQ3VlUG9pbnRzLkFQSSwgJ2dldE1lZGlhQnlJZCcpLmFuZC5jYWxsRmFrZShcbiAgICAgICAgICAgICgpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gcmVmLm5hdGl2ZUVsZW1lbnQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG5cbiAgICAgICAgc3B5T24ocmVmLm5hdGl2ZUVsZW1lbnQuc3Vic2NyaXB0aW9ucy5sb2FkZWRNZXRhZGF0YSwgJ3N1YnNjcmliZScpLmFuZC5jYWxsVGhyb3VnaCgpO1xuXG4gICAgICAgIHNjcnViQmFyQ3VlUG9pbnRzLm9uUGxheWVyUmVhZHkoKTtcblxuICAgICAgICBleHBlY3QocmVmLm5hdGl2ZUVsZW1lbnQuc3Vic2NyaXB0aW9ucy5sb2FkZWRNZXRhZGF0YS5zdWJzY3JpYmUpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcbiAgICB9KTtcbn0pO1xuIl19