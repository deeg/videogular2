"use strict";
var vg_track_selector_1 = require("./vg-track-selector");
var vg_api_1 = require("../../services/vg-api");
describe('Track Selector control', function () {
    var vgTrackSelector;
    function createSubtitleTrack(label, srclang, isDefault) {
        var track = {};
        track.tagName = 'TRACK';
        track.kind = 'subtitles';
        track.label = label;
        track.srclang = srclang;
        track.default = isDefault;
        return track;
    }
    beforeEach(function () {
        var ref = {
            nativeElement: {
                getAttribute: function (name) {
                    return name;
                }
            }
        };
        vgTrackSelector = new vg_track_selector_1.VgTrackSelector(ref, new vg_api_1.VgAPI());
    });
    describe('onPlayerReady', function () {
        beforeEach(function () {
            vgTrackSelector.API.getMasterMedia = function () {
                return { elem: {
                        children: [
                            createSubtitleTrack('English', 'en', false),
                            createSubtitleTrack('Español', 'es', true),
                            {},
                            {},
                            {}
                        ]
                    } };
            };
        });
        it('Should show subtitles tracks only', function () {
            vgTrackSelector.onPlayerReady();
            expect(vgTrackSelector.tracks.length).toBe(3); // 2 subs + 'Off'
        });
        it('Should set the selected option', function () {
            vgTrackSelector.onPlayerReady();
            expect(vgTrackSelector.tracks.filter(function (item) { return item.selected === true; })[0].label).toBe('Español');
        });
        it('Should have an Off option', function () {
            vgTrackSelector.onPlayerReady();
            expect(vgTrackSelector.tracks.filter(function (item) { return item.label === 'Off'; }).length).toBe(1);
        });
        it('Should set Off option as selected when there is no default track', function () {
            vgTrackSelector.API.getMasterMedia = function () {
                return { elem: {
                        children: [
                            createSubtitleTrack('English', 'en', false),
                            createSubtitleTrack('Español', 'es', false)
                        ]
                    } };
            };
            vgTrackSelector.onPlayerReady();
            expect(vgTrackSelector.tracks.filter(function (item) { return item.selected === true; })[0].label).toBe('Off');
        });
    });
    describe('selectTrack', function () {
        beforeEach(function () {
            spyOn(vgTrackSelector.API, 'getMasterMedia').and.returnValue({
                elem: {
                    textTracks: [
                        { mode: 'showing', language: 'en' },
                        { mode: 'hidden', language: 'es' }
                    ]
                }
            });
        });
        it('Should select by track id', function () {
            vgTrackSelector.selectTrack('es');
            expect(vgTrackSelector.API.getMasterMedia().elem
                .textTracks
                .filter(function (item) { return item.mode === 'showing'; })[0].language).toBe('es');
        });
        it('Should select Off when track id is null', function () {
            vgTrackSelector.selectTrack(null);
            expect(vgTrackSelector.API.getMasterMedia().elem
                .textTracks
                .filter(function (item) { return item.mode === 'showing'; }).length).toBe(0);
        });
    });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmctdHJhY2stc2VsZWN0b3Iuc3BlYy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbInZnLXRyYWNrLXNlbGVjdG9yLnNwZWMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLGtDQUE4QixxQkFBcUIsQ0FBQyxDQUFBO0FBQ3BELHVCQUFvQix1QkFBdUIsQ0FBQyxDQUFBO0FBRzVDLFFBQVEsQ0FBQyx3QkFBd0IsRUFBRTtJQUMvQixJQUFJLGVBQStCLENBQUM7SUFFcEMsNkJBQTZCLEtBQVksRUFBRSxPQUFjLEVBQUUsU0FBaUI7UUFDeEUsSUFBTSxLQUFLLEdBQW9CLEVBQXNCLENBQUM7UUFDckQsS0FBYSxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUM7UUFDakMsS0FBSyxDQUFDLElBQUksR0FBRyxXQUFXLENBQUM7UUFDekIsS0FBSyxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7UUFDcEIsS0FBSyxDQUFDLE9BQU8sR0FBRyxPQUFPLENBQUM7UUFDeEIsS0FBSyxDQUFDLE9BQU8sR0FBRyxTQUFTLENBQUM7UUFDMUIsTUFBTSxDQUFDLEtBQUssQ0FBQztJQUNqQixDQUFDO0lBRUQsVUFBVSxDQUFDO1FBQ1AsSUFBTSxHQUFHLEdBQWM7WUFDbkIsYUFBYSxFQUFFO2dCQUNYLFlBQVksRUFBRSxVQUFDLElBQUk7b0JBQ2YsTUFBTSxDQUFDLElBQUksQ0FBQztnQkFDaEIsQ0FBQzthQUNKO1NBQ0osQ0FBQztRQUNGLGVBQWUsR0FBRyxJQUFJLG1DQUFlLENBQUMsR0FBRyxFQUFFLElBQUksY0FBSyxFQUFFLENBQUMsQ0FBQztJQUM1RCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxlQUFlLEVBQUU7UUFDdEIsVUFBVSxDQUFDO1lBQ1AsZUFBZSxDQUFDLEdBQUcsQ0FBQyxjQUFjLEdBQUc7Z0JBQ2pDLE1BQU0sQ0FBQyxFQUFDLElBQUksRUFBRTt3QkFDVixRQUFRLEVBQUU7NEJBQ04sbUJBQW1CLENBQUMsU0FBUyxFQUFFLElBQUks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Q2hDLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUNwQixDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNqQixDQUFDLENBQUMsQ0FBQztRQUNILEVBQUUsQ0FBQyx5Q0FBeUMsRUFBRTtZQUMxQyxlQUFlLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ2xDLE1BQU0sQ0FDRCxlQUFlLENBQUMsR0FBRyxDQUFDLGNBQWMsRUFBRSxDQUFDLElBQVk7aUJBQzdDLFVBQVU7aUJBQ1YsTUFBTSxDQUNILFVBQUMsSUFBSSxJQUFHLE9BQUEsSUFBSSxDQUFDLElBQUksS0FBRyxTQUFTLEVBQXJCLENBQXFCLENBQ2hDLENBQUMsTUFBTSxDQUNmLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2QsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztBQUNQLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtWZ1RyYWNrU2VsZWN0b3J9IGZyb20gXCIuL3ZnLXRyYWNrLXNlbGVjdG9yXCI7XG5pbXBvcnQge1ZnQVBJfSBmcm9tIFwiLi4vLi4vc2VydmljZXMvdmctYXBpXCI7XG5pbXBvcnQge0VsZW1lbnRSZWZ9IGZyb20gXCJAYW5ndWxhci9jb3JlXCI7XG5cbmRlc2NyaWJlKCdUcmFjayBTZWxlY3RvciBjb250cm9sJywgKCkgPT4ge1xuICAgIGxldCB2Z1RyYWNrU2VsZWN0b3I6VmdUcmFja1NlbGVjdG9yO1xuXG4gICAgZnVuY3Rpb24gY3JlYXRlU3VidGl0bGVUcmFjayhsYWJlbDpzdHJpbmcsIHNyY2xhbmc6c3RyaW5nLCBpc0RlZmF1bHQ6Ym9vbGVhbikge1xuICAgICAgICBjb25zdCB0cmFjazpIVE1MVHJhY2tFbGVtZW50ID0ge30gYXMgSFRNTFRyYWNrRWxlbWVudDtcbiAgICAgICAgKHRyYWNrIGFzIGFueSkudGFnTmFtZSA9ICdUUkFDSyc7XG4gICAgICAgIHRyYWNrLmtpbmQgPSAnc3VidGl0bGVzJztcbiAgICAgICAgdHJhY2subGFiZWwgPSBsYWJlbDtcbiAgICAgICAgdHJhY2suc3JjbGFuZyA9IHNyY2xhbmc7XG4gICAgICAgIHRyYWNrLmRlZmF1bHQgPSBpc0RlZmF1bHQ7XG4gICAgICAgIHJldHVybiB0cmFjaztcbiAgICB9XG5cbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgICAgY29uc3QgcmVmOkVsZW1lbnRSZWYgPSB7XG4gICAgICAgICAgICBuYXRpdmVFbGVtZW50OiB7XG4gICAgICAgICAgICAgICAgZ2V0QXR0cmlidXRlOiAobmFtZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmFtZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHZnVHJhY2tTZWxlY3RvciA9IG5ldyBWZ1RyYWNrU2VsZWN0b3IocmVmLCBuZXcgVmdBUEkoKSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnb25QbGF5ZXJSZWFkeScsICgpID0+IHtcbiAgICAgICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICAgICAgICB2Z1RyYWNrU2VsZWN0b3IuQVBJLmdldE1hc3Rlck1lZGlhID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiB7ZWxlbToge1xuICAgICAgICAgICAgICAgICAgICBjaGlsZHJlbjogW1xuICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlU3VidGl0bGVUcmFjaygnRW5nbGlzaCcsICdlbicsIGZhbHNlKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZVN1YnRpdGxlVHJhY2soJ0VzcGHDsW9sJywgJ2VzJywgdHJ1ZSksXG4gICAgICAgICAgICAgICAgICAgICAgICB7fSBhcyBIVE1MVHJhY2tFbGVtZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAge30gYXMgSFRNTFRyYWNrRWxlbWVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHt9IGFzIEhUTUxUcmFja0VsZW1lbnRcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH19IGFzIGFueTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgICAgICBpdCgnU2hvdWxkIHNob3cgc3VidGl0bGVzIHRyYWNrcyBvbmx5JywgKCk9PiB7XG4gICAgICAgICAgICB2Z1RyYWNrU2VsZWN0b3Iub25QbGF5ZXJSZWFkeSgpO1xuICAgICAgICAgICAgZXhwZWN0KHZnVHJhY2tTZWxlY3Rvci50cmFja3MubGVuZ3RoKS50b0JlKDMpOy8vIDIgc3VicyArICdPZmYnXG4gICAgICAgIH0pO1xuICAgICAgICBpdCgnU2hvdWxkIHNldCB0aGUgc2VsZWN0ZWQgb3B0aW9uJywgKCk9PiB7XG4gICAgICAgICAgICB2Z1RyYWNrU2VsZWN0b3Iub25QbGF5ZXJSZWFkeSgpO1xuICAgICAgICAgICAgZXhwZWN0KHZnVHJhY2tTZWxlY3Rvci50cmFja3MuZmlsdGVyKGl0ZW09Pml0ZW0uc2VsZWN0ZWQ9PT10cnVlKVswXS5sYWJlbCkudG9CZSgnRXNwYcOxb2wnKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGl0KCdTaG91bGQgaGF2ZSBhbiBPZmYgb3B0aW9uJywgKCk9PiB7XG4gICAgICAgICAgICB2Z1RyYWNrU2VsZWN0b3Iub25QbGF5ZXJSZWFkeSgpO1xuICAgICAgICAgICAgZXhwZWN0KHZnVHJhY2tTZWxlY3Rvci50cmFja3MuZmlsdGVyKGl0ZW09Pml0ZW0ubGFiZWw9PT0nT2ZmJykubGVuZ3RoKS50b0JlKDEpO1xuICAgICAgICB9KTtcbiAgICAgICAgaXQoJ1Nob3VsZCBzZXQgT2ZmIG9wdGlvbiBhcyBzZWxlY3RlZCB3aGVuIHRoZXJlIGlzIG5vIGRlZmF1bHQgdHJhY2snLCAoKT0+IHtcbiAgICAgICAgICAgIHZnVHJhY2tTZWxlY3Rvci5BUEkuZ2V0TWFzdGVyTWVkaWEgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtlbGVtOiB7XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkcmVuOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVTdWJ0aXRsZVRyYWNrKCdFbmdsaXNoJywgJ2VuJywgZmFsc2UpLFxuICAgICAgICAgICAgICAgICAgICAgICAgY3JlYXRlU3VidGl0bGVUcmFjaygnRXNwYcOxb2wnLCAnZXMnLCBmYWxzZSlcbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH19IGFzIGFueTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB2Z1RyYWNrU2VsZWN0b3Iub25QbGF5ZXJSZWFkeSgpO1xuICAgICAgICAgICAgZXhwZWN0KHZnVHJhY2tTZWxlY3Rvci50cmFja3MuZmlsdGVyKGl0ZW09Pml0ZW0uc2VsZWN0ZWQ9PT10cnVlKVswXS5sYWJlbCkudG9CZSgnT2ZmJyk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIFxuICAgIGRlc2NyaWJlKCdzZWxlY3RUcmFjaycsICgpID0+IHtcbiAgICAgICAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgICAgICAgICBzcHlPbih2Z1RyYWNrU2VsZWN0b3IuQVBJLCAnZ2V0TWFzdGVyTWVkaWEnKS5hbmQucmV0dXJuVmFsdWUoe1xuICAgICAgICAgICAgICAgIGVsZW06IHtcbiAgICAgICAgICAgICAgICAgICAgdGV4dFRyYWNrczogW1xuICAgICAgICAgICAgICAgICAgICAgICAge21vZGU6ICdzaG93aW5nJywgbGFuZ3VhZ2U6ICdlbid9LFxuICAgICAgICAgICAgICAgICAgICAgICAge21vZGU6ICdoaWRkZW4nLCBsYW5ndWFnZTogJ2VzJ31cbiAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgaXQoJ1Nob3VsZCBzZWxlY3QgYnkgdHJhY2sgaWQnLCAoKT0+IHtcbiAgICAgICAgICAgIHZnVHJhY2tTZWxlY3Rvci5zZWxlY3RUcmFjaygnZXMnKTtcbiAgICAgICAgICAgIGV4cGVjdChcbiAgICAgICAgICAgICAgICAodmdUcmFja1NlbGVjdG9yLkFQSS5nZXRNYXN0ZXJNZWRpYSgpLmVsZW0gYXMgYW55KVxuICAgICAgICAgICAgICAgICAgICAudGV4dFRyYWNrc1xuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKFxuICAgICAgICAgICAgICAgICAgICAgICAgKGl0ZW0pPT5pdGVtLm1vZGU9PT0nc2hvd2luZydcbiAgICAgICAgICAgICAgICAgICAgKVswXS5sYW5ndWFnZVxuICAgICAgICAgICAgKS50b0JlKCdlcycpO1xuICAgICAgICB9KTtcbiAgICAgICAgaXQoJ1Nob3VsZCBzZWxlY3QgT2ZmIHdoZW4gdHJhY2sgaWQgaXMgbnVsbCcsICgpPT4ge1xuICAgICAgICAgICAgdmdUcmFja1NlbGVjdG9yLnNlbGVjdFRyYWNrKG51bGwpO1xuICAgICAgICAgICAgZXhwZWN0KFxuICAgICAgICAgICAgICAgICh2Z1RyYWNrU2VsZWN0b3IuQVBJLmdldE1hc3Rlck1lZGlhKCkuZWxlbSBhcyBhbnkpXG4gICAgICAgICAgICAgICAgICAgIC50ZXh0VHJhY2tzXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIoXG4gICAgICAgICAgICAgICAgICAgICAgICAoaXRlbSk9Pml0ZW0ubW9kZT09PSdzaG93aW5nJ1xuICAgICAgICAgICAgICAgICAgICApLmxlbmd0aFxuICAgICAgICAgICAgKS50b0JlKDApO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn0pO1xuIl19